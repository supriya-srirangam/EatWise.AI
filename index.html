<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eat Wise.AI</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="stylesheet" href="./styles/styles.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-dark">
        <div class="container d-flex justify-content-between">
            <!-- Logo and Brand -->
        <a class="navbar-brand d-flex align-items-center" href="#home">
            <img src="images/EatWise_Ai_logo.png" alt="Eat Wise.AI Logo" width="150" height="150" class="me-2">
            <span class="fw-bold text-light fs-4">Eat Wise.AI</span>
        </a>
            <div class="collapse navbar-collapse justify-content-end" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item active"><a class="nav-link text-dark" href="#home">Home</a></li>
                    <li class="nav-item active"><a class="nav-link text-dark" href="#about-us">About Us</a></li>
                    <li class="nav-item active"><a class="nav-link text-dark" href="#contact-us">Contact Us</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-flex" id="home">
        <div class="hero">
            <h1>Analyze Your Food!</h1>
            <p>Upload an image <strong>or</strong> enter ingredients manually.</p>
            <input type="file" id="imageUpload" accept="image/*" onchange="extractTextFromImage()" class="form-control mb-3">
            <img id="previewImage" src="" style="max-width: 100%; display: none; align-items: center;">
            <p><strong>or</strong></p>
            <textarea id="ingredientsInput" class="form-control mb-3" placeholder="Enter ingredients (e.g., sugar, salt, oil)" ></textarea>
            <button class="btn-analyze" onclick="analyzeFood()">Analyze</button>
            <div class="spinner-border text-primary" id="loadingSpinner" style="display: none;"></div>
        </div>

        <div class="hidden results" id="resultsSection">
            <h2>Results</h2>
            <p><i id="healthScoreIcon" class="fas fa-star"></i> <strong>Health Score:</strong> <span id="healthScore">-</span></p>
            <p><i class="fas fa-exclamation-triangle icon-yellow"></i> <strong>Warnings:</strong> <span id="warnings">-</span></p>
            <p><i class="fas fa-check-circle icon-green"></i> <strong>Alternatives:</strong> <span id="alternatives">-</span></p>
            <button class="btn btn-analyze" onclick="resetAnalysis()">Try Another Food</button>
        </div>
    </div>
    <!-- about us section starting -->
    <section class="about-us" id="about-us">
        <div class="container">
            <!-- Left Side: Image -->
            <div class="about-image">
                <img src="./images/about-us-section-image.jpg" alt="Healthy Food Analysis">
            </div>
            <!-- Right Side: Content -->
            <div class="about-content">
                <h1>Who We Are</h1>
                <p>EatWise AI is a smart food analysis platform that helps users make healthier eating choices using AI technology. Our mission is to empower individuals with nutritional insights and promote mindful eating habits.</p>
                
                <h2>Our Mission</h2>
                <p>We believe in harnessing the power of technology to help people make informed decisions about their diet. EatWise AI simplifies nutrition by analyzing ingredients and providing health scores to improve your eating habits.</p>

                <h2>Why Choose Us?</h2>
                <ul>
                    <li><strong>‚úÖ AI-Powered Food Analysis</strong> ‚Äì Get instant insights on how healthy your meals are.</li>
                    <li><strong>‚úÖ Personalized Recommendations</strong> ‚Äì Tailored suggestions based on your diet.</li>
                    <li><strong>‚úÖ User-Friendly Interface</strong> ‚Äì Simple and easy to navigate for all users.</li>
                </ul>
            </div>
        </div>
    </section>
     <!-- about us section ending -->
    <h2 class="how-it-works-section-heading mb-4">How It Works</h2>
        <div class="how-it-works-cards-alignment">
                <div class="how-it-works-section-cards">
                    <img src="images/upload.png" alt="Upload" class="img-fluid mb-3" style="max-width: 80px;">
                    <h4 class="how-it-works-cards-heading">Upload</h4>
                    <p>Upload a photo or enter ingredients.</p>
                </div>
                <div class="how-it-works-section-cards">
                    <img src="images/smart-farm.png" alt="Analyze" class="img-fluid mb-3" style="max-width: 80px;">
                    <h4 class="how-it-works-cards-heading">Analyze</h4>
                    <p>Our AI analyzes your food.</p>
                </div>
                <div class="how-it-works-section-cards">
                    <img src="images/score.png" alt="Get Score" class="img-fluid mb-3" style="max-width: 80px;">
                    <h4 class="how-it-works-cards-heading">Get Score</h4>
                    <p>Receive a nutritional score.</p>
                </div>
                <div class="how-it-works-section-cards">
                    <img src="images/healthy-food.png" alt="See Alternatives" class="img-fluid mb-3" style="max-width: 80px;">
                    <h4 class="how-it-works-cards-heading">See Alternatives</h4>
                    <p>Discover healthier options.</p>
                </div>
            </div>
            <!-- testimonials section start -->
             <div class="testimonials-section">
              <h2 class="testimonials-section-heading">Testimonials</h2>
              <div class="testimonials-underline-alignment">
              <hr class="testimonials-section-underline"></hr>
            </div>
            <div class="testimonials-section-cards-alignment">
                <div class="testimonials-section-cards">
                 <p>"EatWise AI changed the way I choose my meals! The ingredient analysis helps me make healthier decisions."</p>
                 <div class="testimonials-image-name-alignment">
                 <img src="./images//testimonial-profile-1.jpg" alt="client-profile-image" class="testimonial-image">
                 <p class="client-name">Sarah L, Fitness Enthusiast.</p>
                </div>
                </div>
                <div class="testimonials-section-cards">
                    <p> "I love how easy it is to use! Just enter the ingredients, and it gives a health score instantly!"</p>
                    <div class="testimonials-image-name-alignment">
                    <img src="./images//testimonial-profile-2.jpg" alt="client-profile-image" class="testimonial-image">
                    <p class="client-name">David M, Nutrition Coach.</p>
                   </div>
                   </div>
                   <div class="testimonials-section-cards">
                    <p>"EatWise AI's health rating system is so helpful! It even points out hidden unhealthy ingredients in foods."</p>
                    <div class="testimonials-image-name-alignment">
                    <img src="./images/testimonial-profile-3.jpg" alt="client-profile-image" class="testimonial-image">
                    <p class="client-name"> Lisa W, Food Blogger.</p>
                   </div>
                   </div>
            </div>
             </div>
            <!-- testimonials section ending -->
            <section class="contact-section" id="contact-us">
                <div class="contact-container">
                    <!-- Left Side: Contact Info -->
                    <div class="contact-info">
                        <h2>Get in Touch with EatWise AI</h2>
                        <p>Have a question? Need support? We're here to help!</p>
                        <ul>
                            <li>üìç 123 AI Street, Tech City, Innovation Hub</li>
                            <li>üìû +1 234 567 890</li>
                            <li>üìß support@eatwiseai.com</li>
                            <li>üåê www.eatwiseai.com</li>
                        </ul>
                        <div class="social-icons">
                            <a href="#"><img src="./images/facebook-logo.png" alt="Facebook"></a>
                            <a href="#"><img src="./images/twitter-logo.png" alt="Twitter"></a>
                            <a href="#"><img src="./images/linkedin-logo.png" alt="LinkedIn"></a>
                            <a href="#"><img src="./images/instagram-logo.png" alt="Instagram"></a>
                        </div>
                    </div>
        
                    <!-- Right Side: Contact Form -->
                    <div class="contact-form">
                        <h2>Send Us a Message</h2>
                        <form id="contactForm">
                            <input type="text" id="name" placeholder="Your Name" required>
                            <input type="email" id="email" placeholder="Your Email" required>
                            <textarea id="message" rows="5" placeholder="Your Message" required></textarea>
                            <button type="submit">Send Message</button>
                        </form>
                        <p id="responseMessage"></p>
                    </div>
                </div>
            </section>
    <footer class="footer">
        <p>&copy; 2025 Eat Wise.AI - All Rights Reserved</p>
    </footer>

    <script>
        async function extractTextFromImage() {
    const fileInput = document.getElementById("imageUpload");
    const previewImage = document.getElementById("previewImage");
    const ingredientsInput = document.getElementById("ingredientsInput");

    if (fileInput.files.length === 0) {
        alert("Please upload an image.");
        return;
    }

    const file = fileInput.files[0];
    const reader = new FileReader();

    reader.onload = async function (event) {
        const base64Image = event.target.result.split(",")[1]; // Extract base64 data

        previewImage.src = event.target.result;
        previewImage.style.display = "block"; // Show preview

        const visionApiUrl = `https://vision.googleapis.com/v1/images:annotate?key=apikey`;

        const requestBody = {
            requests: [
                {
                    image: { content: base64Image },
                    features: [{ type: "TEXT_DETECTION" }]
                }
            ]
        };

        try {
            const response = await fetch(visionApiUrl, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(requestBody)
            });

            const data = await response.json();
            console.log("OCR Response:", data);

            if (data.responses && data.responses[0].textAnnotations) {
                const extractedText = data.responses[0].textAnnotations[0].description;
                ingredientsInput.value = extractedText; // Auto-fill ingredients input
            } else {
                alert("No text detected in the image.");
                previewImage.style.display = "none";
                imageUpload.value = "";
            }
        } catch (error) {
            console.error("Error:", error);
            alert("Failed to extract text from image.");
            previewImage.style.display = "none";
            imageUpload.value = "";
        }
    };

    reader.readAsDataURL(file);
}

        async function analyzeFood() {
    const ingredients = document.getElementById("ingredientsInput").value.trim();
    const analyzeButton = document.querySelector(".btn-analyze");
    const loadingSpinner = document.getElementById("loadingSpinner");
    const resultsSection = document.getElementById("resultsSection");
    const healthScoreIcon = document.getElementById("healthScoreIcon");
    const previewImage = document.getElementById("previewImage");
    const imageUpload = document.getElementById("imageUpload");

    if (!ingredients) {
        alert("Please enter ingredients.");
        return;
    }
    // Hide the preview image when analysis starts
    previewImage.style.display = "none";
    imageUpload.value = ""; 
    analyzeButton.disabled = true;
    analyzeButton.innerText = "Analyzing...";
    loadingSpinner.style.display = "inline-block";
    // Clear previous results
    document.getElementById("healthScore").innerText = "-";
    document.getElementById("warnings").innerText = "-";
    document.getElementById("alternatives").innerText = "-";
    resultsSection.style.display = "none";

    try {
        const apiUrl = `https://generativelanguage.googleapis.com/v1/models/gemini-1.5-pro:generateContent?key=AIzaSyCH9UMD7vJ_iuzYFmyT2VGrdyqQqd9cVjE`; // Replace with your API key

        // üîπ **Full Request Body**
        let requestBody = {
                contents: [
                    {
                        role: "model",
                        parts: [
                            {
                                text: `You are an AI nutrition assistant named Eat Wise AI. Your goal is to analyze food ingredients and rate their healthiness based on WHO, USDA, and OpenFoodFacts guidelines.

                                    Objective:
                                    - Analyze food ingredients.
                                    - Assign a health score (0-10).
                                    - Warn about unhealthy components.
                                    - Suggest alternatives.

                                    Constraints:
                                    1. Provide concise, structured, and evidence-based responses.
                                    2. Avoid assumptions beyond ingredient analysis.
                                    3. Stick to well-documented nutrition guidelines.

                                    Persona:
                                    - Supportive and professional nutrition expert.
                                    - User-friendly and informative.

                                    Tone:
                                    - Encouraging, neutral, and informative.

                                    Context:
                                    - Users want to understand the health impact of food ingredients.

                                    Step-by-Step Reasoning:
                                    1. Identify and categorize ingredients.
                                    2. Compare with health guidelines.
                                    3. Compute a health score (0-10).
                                    4. Provide structured feedback.

                                    Expected Response Format:
                                    - **Health Score:** X/10
                                    - **Warnings:** [List of concerns]
                                    - **Alternatives:** [Healthier options]

                                    Examples:
                                    1Ô∏è‚É£ **Input:** "Sugar, Palm Oil, Artificial Flavors"
                                        - **Output:** "Health Score: 3/10, Warnings: [High sugar, artificial additives], Alternatives: [Olive oil, honey, natural flavors]"

                                    2Ô∏è‚É£ **Input:** "Oats, Almonds, Honey"
                                        - **Output:** "Health Score: 9/10, Warnings: [None], Alternatives: [None needed]"`
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            role: "user",
                                                            parts: [
                                                                {
                                                                    text: `Analyze the following food ingredients:

                                    Ingredients: ${ingredients}

                                    Provide output strictly in the structured format mentioned above.`
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                };

        console.log("Request Body:", JSON.stringify(requestBody, null, 2));

        const response = await fetch(apiUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(requestBody)
        });

        if (!response.ok) {
            let errorMessage = `HTTP ${response.status} - ${response.statusText}`;
            const errorResponse = await response.text();
            console.error("Error Details:", errorResponse);
            alert(`API Error: ${errorMessage}`);
            throw new Error(errorMessage);
        }

        const data = await response.json();
        console.log("API Response:", data);

        // Ensure response format is valid
        if (!data || !Array.isArray(data.candidates) || data.candidates.length === 0) {
        alert("Unexpected API response format. Check console.");
        return;
    }

        const responseText = data.candidates[0]?.content?.parts?.[0]?.text || "";
        console.log("Raw Response Text:", responseText);

        // üîπ **Extract Health Score, Warnings, and Alternatives**
        const healthScoreMatch = responseText.match(/\*\*Health Score:\*\*\s*(\d+)/);
        const healthScore = healthScoreMatch ? parseInt(healthScoreMatch[1]) : "-";

        const warningsMatch = responseText.match(/\*\*Warnings:\*\*\s*(.+)/);
        const warnings = warningsMatch ? warningsMatch[1].replace(/\[|\]/g, "") : "None";

        const alternativesMatch = responseText.match(/\*\*Alternatives:\*\*\s*(.+)/);
        const alternatives = alternativesMatch ? alternativesMatch[1].replace(/\[|\]/g, "") : "None";

        // üîπ **Update UI with extracted data**
        document.getElementById("healthScore").innerText = healthScore;
        document.getElementById("warnings").innerText = warnings;
        document.getElementById("alternatives").innerText = alternatives;

        // üîπ **Update Health Score Icon Color**
        healthScoreIcon.classList.remove("text-danger", "text-warning", "text-success");
        if (healthScore !== "-") {
            if (healthScore <= 3) {
                healthScoreIcon.classList.add("text-danger"); // Red
            } else if (healthScore <= 6) {
                healthScoreIcon.classList.add("text-warning"); // Yellow
            } else {
                healthScoreIcon.classList.add("text-success"); // Green
            }
        }

        resultsSection.classList.remove("hidden"); // Ensure it's visible
        resultsSection.style.display = "block";
    } catch (error) {
        console.error("Error:", error);
        alert("An error occurred while analyzing. Please try again later.");
        // Remove uploaded image preview & reset file input if error occurs
        previewImage.style.display = "none";
        imageUpload.value = ""; // Reset file input
    } finally {
        loadingSpinner.style.display = "none";
        analyzeButton.disabled = false;
        analyzeButton.innerText = "Analyze";
    }
}


        function resetAnalysis() {
            document.getElementById("ingredientsInput").value = "";
            document.getElementById("resultsSection").style.display = "none";
            const analyzeButton = document.querySelector(".btn-analyze");
            analyzeButton.disabled = false;
            analyzeButton.innerText = "Analyze";
        }
    </script>
</body>
</html>
