<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Eat Wise.AI</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="config.js"></script>
    <link rel="stylesheet" href="./styles/styles.css">
</head>
<body>
    <!-- navbar section starts -->
    <nav class="navbar navbar-expand-lg navbar-light">
        <div class="container-fluid">
            <img src="./assets/EatWise_Ai_logo.png" alt="eatwise-logo" class="logo"/>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
                aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active nav-items" aria-current="page" href="#home">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active nav-items" href="#about-us">About Us</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active nav-items" href="#testimonials">Testimonials</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active nav-items special" href="#contact-us">Contact Us</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>
      <!-- navbar section ending -->
    <div class="container-flex" id="home">
        <div class="hero">
            <h1>Analyze Your Food!</h1>
            <p>Upload an image <strong>or</strong> enter ingredients manually.</p>
            <input type="file" id="imageUpload" accept="image/*" onchange="extractTextFromImage()" class="form-control mb-3">
            <img id="previewImage" src="" style="max-width: 100%; display: none; align-items: center;">
            <p><strong>or</strong></p>
            <textarea id="ingredientsInput" class="form-control mb-3" placeholder="Enter ingredients (e.g., sugar, salt, oil)" ></textarea>
            <button class="btn-analyze" onclick="analyzeFood()">Analyze</button>
            <div class="spinner-border text-primary" id="loadingSpinner" style="display: none;"></div>
        </div>

        <div class="hidden results" id="resultsSection">
            <h2>Results</h2>
            <p><i id="healthScoreIcon" class="fas fa-star"></i> <strong>Health Score:</strong> <span id="healthScore">-</span></p>
            <p><i class="fas fa-exclamation-triangle icon-yellow"></i> <strong>Warnings:</strong> <span id="warnings">-</span></p>
            <p><i class="fas fa-check-circle icon-green"></i> <strong>Alternatives:</strong> <span id="alternatives">-</span></p>
            <button class="btn btn-analyze" onclick="resetAnalysis()">Try Another Food</button>
        </div>
    </div>
    <!-- about us section starting -->
    <section class="about-us" id="about-us">
        <div class="container">
            <div class="about-image">
                <img src="./assets/healthy_food.jpg" alt="Healthy Food Analysis">
            </div>
            <!-- Right Side: Content -->
            <div class="about-content">
                <h1 class="about-content-heading">Who We Are</h1>
                <p>EatWise AI is a smart food analysis platform that helps users make healthier eating choices using AI technology. Our mission is to empower individuals with nutritional insights and promote mindful eating habits.</p>
                
                <h2 class="about-content-heading">Our Mission</h2>
                <p>We believe in harnessing the power of technology to help people make informed decisions about their diet. EatWise AI simplifies nutrition by analyzing ingredients and providing health scores to improve your eating habits.</p>

                <h2 class="about-content-heading">Why Choose Us?</h2>
                <ul>
                    <li><strong>✅ AI-Powered Food Analysis</strong> – Get instant insights on how healthy your meals are.</li>
                    <li><strong>✅ Personalized Recommendations</strong> – Tailored suggestions based on your diet.</li>
                    <li><strong>✅ User-Friendly Interface</strong> – Simple and easy to navigate for all users.</li>
                </ul>
            </div>
        </div>
    </section>
     <!-- about us section ending -->
      <section class="how-it-works-section">
    <h2 class="how-it-works-section-heading mb-3 mt-3 col-sm-12" id="how-it-works">How It Works</h2>
    <div class="container">
        <div class="row">
        <!-- <div class="how-it-works-cards-alignment"> -->
            <div class="col-sm-10 col-md-5 col-lg-3">
                <div class="how-it-works-section-cards">
                    <img src="assets/upload.png" alt="Upload" class="img-fluid mb-3" style="max-width: 80px;">
                    <h4 class="how-it-works-cards-heading">Upload</h4>
                    <p>Upload a photo or enter ingredients.</p>
                </div>
            </div>
            <div class="col-sm-10 col-md-5 col-lg-3">
                <div class="how-it-works-section-cards">
                    <img src="assets/smart-farm.png" alt="Analyze" class="img-fluid mb-3" style="max-width: 80px;">
                    <h4 class="how-it-works-cards-heading">Analyze</h4>
                    <p>Our AI analyzes your food.</p>
                </div>
            </div>
            <div class="col-sm-10 col-md-5 col-lg-3">
                <div class="how-it-works-section-cards">
                    <img src="assets/score.png" alt="Get Score" class="img-fluid mb-3" style="max-width: 80px;">
                    <h4 class="how-it-works-cards-heading">Get Score</h4>
                    <p>Receive a nutritional score.</p>
                </div>
                </div>
                <div class="col-sm-10 col-md-5 col-lg-3">
                <div class="how-it-works-section-cards">
                    <img src="assets/healthy-food.png" alt="See Alternatives" class="img-fluid mb-3" style="max-width: 80px;">
                    <h4 class="how-it-works-cards-heading">See Alternatives</h4>
                    <p>Discover healthier options.</p>
                    </div>
                </div>
            <!-- </div> -->
    </div>
</div>
</section>
<!-- pricing section starts -->
 <!-- Pricing Section -->
<section class="pricing-section py-5">
    <h2 class="how-it-works-section-heading mb-3 mt-3 col-sm-12">Choose your plan</h2>
    <div class="container">
      <div class="row">
        <!-- Basic Plan -->
        <div class="col-md-4">
          <div class="card pricing-card">
            <div class="card-body text-center">
              <h5 class="card-title">Basic Plan</h5>
              <h3 class="price">$0<span>/month</span></h3>
              <p>For individuals and beginners</p>
              <ul class="list-unstyled">
                <li>✔ Basic AI Predictions</li>
                <li>✔ 5 Free Reports</li>
                <li>✖ No Priority Support</li>
              </ul>
              <button class="btn btn-outline-success">Get Started</button>
            </div>
          </div>
        </div>
  
        <!-- Pro Plan -->
        <div class="col-md-4">
          <div class="card pricing-card">
            <div class="card-body text-center">
              <h5 class="card-title">Pro Plan</h5>
              <h3 class="price">$19<span>/month</span></h3>
              <p>For professionals & small businesses</p>
              <ul class="list-unstyled">
                <li>✔ Advanced AI Predictions</li>
                <li>✔ 50 Reports per month</li>
                <li>✔ Priority Email Support</li>
              </ul>
              <button class="btn btn-outline-success">Get Started</button>
            </div>
          </div>
        </div>
  
        <!-- Enterprise Plan -->
        <div class="col-md-4">
          <div class="card pricing-card">
            <div class="card-body text-center">
              <h5 class="card-title">Enterprise Plan</h5>
              <h3 class="price">$49<span>/month</span></h3>
              <p>For large-scale businesses</p>
              <ul class="list-unstyled">
                <li>✔ Unlimited AI Predictions</li>
                <li>✔ Unlimited Reports</li>
                <li>✔ 24/7 Priority Support</li>
              </ul>
              <button class="btn btn-outline-success">Get Started</button>
            </div>
          </div>
        </div>
  
      </div>
    </div>
  </section>  
 <!-- pricing section ending -->
            <!-- testimonials section start -->
            <div class="testimonials" id="testimonials">
              <h2 class="testimonials-section-heading text-center">Testimonials</h2>
              <div class="testimonials-underline-alignment">
              <hr class="testimonials-section-underline"></hr>
            </div>
            <div class="container-fluid">
                <div class="row">
            <!-- <div class="testimonials-section-cards-alignment"> -->
                <div class="col-sm-10 col-md-4">
                <div class="testimonials-section-cards">
                 <p>"EatWise AI changed the way I choose my meals! The ingredient analysis helps me make healthier decisions."</p>
                 <div class="testimonials-image-name-alignment">
                 <img src="./assets//testimonial-profile-1.jpg" alt="client-profile-image" class="testimonial-image">
                 <p class="client-name">Sarah L, Fitness Enthusiast.</p>
                </div>
                </div>
                </div>
                <div class="col-sm-10 col-md-4">
                <div class="testimonials-section-cards">
                    <p> "I love how easy it is to use! Just enter the ingredients, and it gives a health score instantly!"</p>
                    <div class="testimonials-image-name-alignment">
                    <img src="./assets//testimonial-profile-2.jpg" alt="client-profile-image" class="testimonial-image">
                    <p class="client-name">David M, Nutrition Coach.</p>
                   </div>
                   </div>
                   </div>
                   <div class="col-sm-10 col-md-4">
                   <div class="testimonials-section-cards">
                    <p>"EatWise AI's health rating system is so helpful! It even points out hidden unhealthy ingredients in foods."</p>
                    <div class="testimonials-image-name-alignment">
                    <img src="./assets/testimonial-profile-3.jpg" alt="client-profile-image" class="testimonial-image">
                    <p class="client-name"> Lisa W, Food Blogger.</p>
                   </div>
                   </div>
                   </div>
            <!-- </div> -->
             </div>
             </div>
            </div>
            <!-- testimonials section ending -->
            
            <section class="contact-section" id="contact-us">
                <h2 class="testimonials-section-heading">Contact Us</h2>
                <div class="contact-container">
                    <!-- Left Side: Contact Info -->
                    <div class="contact-info">
                        <h2>Get in Touch with EatWise AI</h2>
                        <p>Have a question? Need support? We're here to help!</p>
                        <ul>
                            <li>📍 123 AI Street, Tech City, Innovation Hub</li>
                            <li>📞 +1 234 567 890</li>
                            <li>📧 support@eatwiseai.com</li>
                            <li>🌐 www.eatwiseai.com</li>
                        </ul>
                        <div class="social-icons">
                            <a href="#"><img src="./assets/facebook-logo.png" alt="Facebook"></a>
                            <a href="#"><img src="./assets/twitter-logo.png" alt="Twitter"></a>
                            <a href="#"><img src="./assets/linkedin-logo.png" alt="LinkedIn"></a>
                            <a href="#"><img src="./assets/instagram-logo.png" alt="Instagram"></a>
                        </div>
                    </div>
        
                    <!-- Right Side: Contact Form -->
                    <div class="contact-form" id="contact-us">
                        <h2>Send Us a Message</h2>
                        <form id="contactForm">
                            <input type="text" id="name" placeholder="Your Name" required>
                            <input type="email" id="email" placeholder="Your Email" required>
                            <textarea id="message" rows="5" placeholder="Your Message" required></textarea>
                            <button type="submit">Send Message</button>
                        </form>
                        <p id="responseMessage"></p>
                    </div>
                </div>
            </section>
    <footer class="footer">
        <p>&copy; 2025 Eat Wise.AI - All Rights Reserved</p>
    </footer>

    <script>
        async function extractTextFromImage() {
    const fileInput = document.getElementById("imageUpload");
    const previewImage = document.getElementById("previewImage");
    const ingredientsInput = document.getElementById("ingredientsInput");

    if (fileInput.files.length === 0) {
        alert("Please upload an image.");
        return;
    }

    const file = fileInput.files[0];
    const reader = new FileReader();

    reader.onload = async function (event) {
        const base64Image = event.target.result.split(",")[1]; 

        previewImage.src = event.target.result;
        previewImage.style.display = "block"; 

        const visionApiUrl = `https://vision.googleapis.com/v1/images:annotate?key=apikey`;

        const requestBody = {
            requests: [
                {
                    image: { content: base64Image },
                    features: [{ type: "TEXT_DETECTION" }]
                }
            ]
        };

        try {
            const response = await fetch(visionApiUrl, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify(requestBody)
            });

            const data = await response.json();
            console.log("OCR Response:", data);

            if (data.responses && data.responses[0].textAnnotations) {
                const extractedText = data.responses[0].textAnnotations[0].description;
                ingredientsInput.value = extractedText; 
            } else {
                alert("No text detected in the image.");
                previewImage.style.display = "none";
                imageUpload.value = "";
            }
        } catch (error) {
            console.error("Error:", error);
            alert("Failed to extract text from image.");
            previewImage.style.display = "none";
            imageUpload.value = "";
        }
    };

    reader.readAsDataURL(file);
}

        async function analyzeFood() {
    const ingredients = document.getElementById("ingredientsInput").value.trim();
    const analyzeButton = document.querySelector(".btn-analyze");
    const loadingSpinner = document.getElementById("loadingSpinner");
    const resultsSection = document.getElementById("resultsSection");
    const healthScoreIcon = document.getElementById("healthScoreIcon");
    const previewImage = document.getElementById("previewImage");
    const imageUpload = document.getElementById("imageUpload");

    if (!ingredients) {
        alert("Please enter ingredients.");
        return;
    }
    previewImage.style.display = "none";
    imageUpload.value = ""; 
    analyzeButton.disabled = true;
    analyzeButton.innerText = "Analyzing...";
    loadingSpinner.style.display = "inline-block";
    document.getElementById("healthScore").innerText = "-";
    document.getElementById("warnings").innerText = "-";
    document.getElementById("alternatives").innerText = "-";
    resultsSection.style.display = "none";

    try {
        const apiUrl = `https://generativelanguage.googleapis.com/v1/models/gemini-1.5-pro:generateContent?key=${CONFIG.API_KEY}`; // Replace with your API key

        let requestBody = {
                contents: [
                    {
                        role: "model",
                        parts: [
                            {
                                text: `You are an AI nutrition assistant named Eat Wise AI. Your goal is to analyze food ingredients and rate their healthiness based on WHO, USDA, and OpenFoodFacts guidelines.

                                    Objective:
                                    - Analyze food ingredients.
                                    - Assign a health score (0-10).
                                    - Warn about unhealthy components.
                                    - Suggest alternatives.

                                    Constraints:
                                    1. Provide concise, structured, and evidence-based responses.
                                    2. Avoid assumptions beyond ingredient analysis.
                                    3. Stick to well-documented nutrition guidelines.

                                    Persona:
                                    - Supportive and professional nutrition expert.
                                    - User-friendly and informative.

                                    Tone:
                                    - Encouraging, neutral, and informative.

                                    Context:
                                    - Users want to understand the health impact of food ingredients.

                                    Step-by-Step Reasoning:
                                    1. Identify and categorize ingredients.
                                    2. Compare with health guidelines.
                                    3. Compute a health score (0-10).
                                    4. Provide structured feedback.

                                    Expected Response Format:
                                    - **Health Score:** X/10
                                    - **Warnings:** [List of concerns]
                                    - **Alternatives:** [Healthier options]

                                    Examples:
                                    1️⃣ **Input:** "Sugar, Palm Oil, Artificial Flavors"
                                        - **Output:** "Health Score: 3/10, Warnings: [High sugar, artificial additives], Alternatives: [Olive oil, honey, natural flavors]"

                                    2️⃣ **Input:** "Oats, Almonds, Honey"
                                        - **Output:** "Health Score: 9/10, Warnings: [None], Alternatives: [None needed]"`
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            role: "user",
                                                            parts: [
                                                                {
                                                                    text: `Analyze the following food ingredients:

                                    Ingredients: ${ingredients}

                                    Provide output strictly in the structured format mentioned above.`
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                };

        console.log("Request Body:", JSON.stringify(requestBody, null, 2));

        const response = await fetch(apiUrl, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify(requestBody)
        });

        if (!response.ok) {
            let errorMessage = `HTTP ${response.status} - ${response.statusText}`;
            const errorResponse = await response.text();
            console.error("Error Details:", errorResponse);
            alert(`API Error: ${errorMessage}`);
            throw new Error(errorMessage);
        }

        const data = await response.json();
        console.log("API Response:", data);

        if (!data || !Array.isArray(data.candidates) || data.candidates.length === 0) {
        alert("Unexpected API response format. Check console.");
        return;
    }

        const responseText = data.candidates[0]?.content?.parts?.[0]?.text || "";
        console.log("Raw Response Text:", responseText);

        const healthScoreMatch = responseText.match(/\*\*Health Score:\*\*\s*(\d+)/);
        const healthScore = healthScoreMatch ? parseInt(healthScoreMatch[1]) : "-";

        const warningsMatch = responseText.match(/\*\*Warnings:\*\*\s*(.+)/);
        const warnings = warningsMatch ? warningsMatch[1].replace(/\[|\]/g, "") : "None";

        const alternativesMatch = responseText.match(/\*\*Alternatives:\*\*\s*(.+)/);
        const alternatives = alternativesMatch ? alternativesMatch[1].replace(/\[|\]/g, "") : "None";

        //Updating UI with extracted data
        document.getElementById("healthScore").innerText = healthScore !== "-" ? `${healthScore}/10` : "-";
        document.getElementById("warnings").innerText = warnings;
        document.getElementById("alternatives").innerText = alternatives;

        // Updating Health Score Icon Color
        healthScoreIcon.classList.remove("text-danger", "text-warning", "text-success");
        if (healthScore !== "-") {
            if (healthScore <= 3) {
                healthScoreIcon.classList.add("text-danger"); 
            } else if (healthScore <= 6) {
                healthScoreIcon.classList.add("text-warning"); 
            } else {
                healthScoreIcon.classList.add("text-success"); 
            }
        }

        resultsSection.classList.remove("hidden"); 
        resultsSection.style.display = "block";
    } catch (error) {
        console.error("Error:", error);
        alert("An error occurred while analyzing. Please try again later.");
        previewImage.style.display = "none";
        imageUpload.value = ""; 
    } finally {
        loadingSpinner.style.display = "none";
        analyzeButton.disabled = false;
        analyzeButton.innerText = "Analyze";
    }
}


        function resetAnalysis() {
            document.getElementById("ingredientsInput").value = "";
            document.getElementById("resultsSection").style.display = "none";
            const analyzeButton = document.querySelector(".btn-analyze");
            analyzeButton.disabled = false;
            analyzeButton.innerText = "Analyze";
        }
    </script>
</body>
</html>
